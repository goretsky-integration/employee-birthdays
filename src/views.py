import random
from collections.abc import Iterable
from typing import Final

from models import EmployeeBirthday

__all__ = ('render_congratulations',)

CONGRATULATIONS_PHRASES: Final[tuple[str, ...]] = (
    '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –≤–∞–∂–Ω—ã–º –¥–Ω–µ–º!'
    ' –ñ–µ–ª–∞–µ–º, —á—Ç–æ–±—ã —ç—Ç–æ—Ç –≥–æ–¥ –ø—Ä–∏–Ω–µ—Å –≤–∞–º –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∏ —Ä–∞–¥–æ—Å—Ç–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è.',

    '–° –Ω–∞–∏–ª—É—á—à–∏–º–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è–º–∏ –≤ —ç—Ç–æ—Ç –æ—Å–æ–±—ã–π –¥–µ–Ω—å.'
    ' –ü—É—Å—Ç—å —Å–æ–ª–Ω—Ü–µ –≤—Å–µ–≥–¥–∞ —Å–∏—è–µ—Ç —è—Ä–∫–æ –Ω–∞–¥ –≤–∞—à–∏–º –ø—É—Ç–µ–º.',

    '–ñ–µ–ª–∞–µ–º –≤–∞–º –∑–¥–æ—Ä–æ–≤—å—è, —Å—á–∞—Å—Ç—å—è –∏ —É—Å–ø–µ—Ö–æ–≤ –Ω–∞ –≤—Å–µ—Ö –ø—É—Ç—è—Ö –≤–∞—à–µ–π –∂–∏–∑–Ω–∏.'
    ' –ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø—Ä–∏–Ω–æ—Å–∏—Ç –≤–∞–º —Ä–∞–¥–æ—Å—Ç—å –∏ —É–ª—ã–±–∫—É.',

    '–° –¥–Ω–µ–º —Ä–æ–∂–¥–µ–Ω–∏—è! –ñ–µ–ª–∞–µ–º –≤–∞–º –º–Ω–æ–≥–æ –Ω–æ–≤—ã—Ö –∏ —è—Ä–∫–∏—Ö –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–π,'
    ' –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –∏ —Ä–∞–¥–æ—Å—Ç–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á.',

    '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–º! –ü—É—Å—Ç—å –≤–∞—à –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –±—É–¥–µ—Ç –Ω–∞–ø–æ–ª–Ω–µ–Ω –ª—é–±–æ–≤—å—é,'
    ' —Å—á–∞—Å—Ç—å–µ–º –∏ –¥—É—à–µ–≤–Ω—ã–º —Ç–µ–ø–ª–æ–º.',

    '–ñ–µ–ª–∞–µ–º –≤–∞–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—Å–µ—Ö –∑–∞–¥—É–º–∞–Ω–Ω—ã—Ö —Ü–µ–ª–µ–π,'
    ' —Å–º–µ–ª–æ—Å—Ç–∏ –ø—Ä–µ–æ–¥–æ–ª–µ–≤–∞—Ç—å –ø—Ä–µ–≥—Ä–∞–¥—ã –∏ –º—É–¥—Ä–æ—Å—Ç–∏ –≤ –ø—Ä–∏–Ω—è—Ç–∏–∏ –≤–∞–∂–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π.',

    '–ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –≤–∞—à –¥–µ–Ω—å –±—É–¥–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω–æ –≤–æ–ª—à–µ–±–Ω—ã–º,'
    ' –Ω–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–º —Å—á–∞—Å—Ç—å–µ–º, –¥–æ–±—Ä–æ—Ç–æ–π –∏ —É–ª—ã–±–∫–∞–º–∏.',

    '–°–µ–≥–æ–¥–Ω—è –≤–∞—à –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è, –∏ –ø—É—Å—Ç—å –≤–µ—Å—å –º–∏—Ä —Ä–∞–¥—É–µ—Ç—Å—è —ç—Ç–æ–º—É —Å –≤–∞–º–∏!'
    ' –ñ–µ–ª–∞–µ–º –≤–∞–º –≤—Å–µ —Å–∞–º–æ–µ –ª—É—á—à–µ–µ –≤ –∂–∏–∑–Ω–∏.',

    '–û—Ç –≤—Å–µ–≥–æ —Å–µ—Ä–¥—Ü–∞ –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –¥–Ω–µ–º —Ä–æ–∂–¥–µ–Ω–∏—è!'
    ' –ü—É—Å—Ç—å –æ–Ω —Å—Ç–∞–Ω–µ—Ç –Ω–∞—á–∞–ª–æ–º –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –∏ –≤–µ–ª–∏–∫–∏—Ö –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–π.',

    '–° –¥–Ω–µ–º —Ä–æ–∂–¥–µ–Ω–∏—è! –ñ–µ–ª–∞–µ–º –≤–∞–º –ª—é–±–≤–∏, —Ä–∞–¥–æ—Å—Ç–∏ –∏ –±–ª–∞–≥–æ–ø–æ–ª—É—á–∏—è.'
    ' –ü—É—Å—Ç—å –≤–∞—à–∞ –∂–∏–∑–Ω—å –±—É–¥–µ—Ç —è—Ä–∫–æ–π –∏ –Ω–∞—Å—ã—â–µ–Ω–Ω–æ–π —Å—á–∞—Å—Ç–ª–∏–≤—ã–º–∏ –º–æ–º–µ–Ω—Ç–∞–º–∏.',

    '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –æ—Å–æ–±—ã–º –¥–Ω–µ–º! –ñ–µ–ª–∞–µ–º,'
    ' —á—Ç–æ–±—ã –∫–∞–∂–¥—ã–π –º–æ–º–µ–Ω—Ç –≤–∞—à–µ–π –∂–∏–∑–Ω–∏ –±—ã–ª –Ω–∞–ø–æ–ª–Ω–µ–Ω —Ä–∞–¥–æ—Å—Ç—å—é –∏ —Å—á–∞—Å—Ç—å–µ–º.',

    '–° –¥–Ω–µ–º —Ä–æ–∂–¥–µ–Ω–∏—è! –ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –±—É–¥–µ—Ç –Ω–∞—á–∞–ª–æ–º –Ω–æ–≤–æ–π –≥–ª–∞–≤—ã –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏,'
    ' –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π.',

    '–ñ–µ–ª–∞–µ–º –≤–∞–º –ø—Ä–µ–∫—Ä–∞—Å–Ω—ã—Ö –º–≥–Ω–æ–≤–µ–Ω–∏–π –∏ –Ω–∏ –æ–¥–Ω–æ–π —Ç–µ–Ω–∏ –Ω–∞ –≤–∞—à–µ–º –ø—É—Ç–∏.'
    ' –ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –ø—Ä–∏–Ω–µ—Å–µ—Ç –≤–∞–º —Ä–∞–¥–æ—Å—Ç—å –∏ —É–ª—ã–±–∫—É.',

    '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å –≤–∞–∂–Ω—ã–º —Å–æ–±—ã—Ç–∏–µ–º! –ñ–µ–ª–∞–µ–º, —á—Ç–æ–±—ã –≤–∞—à –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è'
    ' —Å—Ç–∞–ª —Ç—Ä–µ–ø–µ—Ç–Ω—ã–º –º–æ–º–µ–Ω—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–ø–æ–º–Ω–∏—Ç—Å—è –Ω–∞–¥–æ–ª–≥–æ.',

    '–ü—É—Å—Ç—å —Å–æ–ª–Ω—Ü–µ –≤—Å–µ–≥–¥–∞ —Å–≤–µ—Ç–∏—Ç –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏,'
    ' –∞ –¥–æ–∂–¥—å –ø—Ä–æ–ª–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª–∏–≤–∞ –≤–∞—à–µ–≥–æ —Å—á–∞—Å—Ç—å—è. –° –¥–Ω–µ–º —Ä–æ–∂–¥–µ–Ω–∏—è!',

    '–° –Ω–∞–∏–ª—É—á—à–∏–º–∏ –ø–æ–∂–µ–ª–∞–Ω–∏—è–º–∏ –≤ —ç—Ç–æ—Ç —Ä–∞–¥–æ—Å—Ç–Ω—ã–π –¥–µ–Ω—å! –ü—É—Å—Ç—å –∑–≤–µ–∑–¥—ã –≤—Å–µ–≥–¥–∞'
    ' –±–ª–∞–≥–æ—Å–∫–ª–æ–Ω–Ω—ã –∫ –≤–∞–º, –∞ —É–¥–∞—á–∞ —Å–æ–ø—É—Ç—Å—Ç–≤—É–µ—Ç –≤–æ –≤—Å–µ—Ö –Ω–∞—á–∏–Ω–∞–Ω–∏—è—Ö.',

    '–ñ–µ–ª–∞–µ–º –≤–∞–º —Å–∏—è—é—â–µ–≥–æ –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è, –Ω–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ –ª—é–±–æ–≤—å—é –∏ –∫—Ä–∞—Å–æ—Ç–æ–π.'
    ' –ü—É—Å—Ç—å –æ–Ω —Å—Ç–∞–Ω–µ—Ç –Ω–∞—á–∞–ª–æ–º —Å–∞–º—ã—Ö —è—Ä–∫–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏.',

    '–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º —Å —ç—Ç–∏–º –≤–æ–ª—à–µ–±–Ω—ã–º –¥–Ω–µ–º! –ñ–µ–ª–∞–µ–º, —á—Ç–æ–±—ã –≤–∞—à–µ —Å–µ—Ä–¥—Ü–µ –≤—Å–µ–≥–¥–∞ –±—ã–ª–æ'
    ' –Ω–∞–ø–æ–ª–Ω–µ–Ω–æ —Ä–∞–¥–æ—Å—Ç—å—é –∏ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç—å—é –∑–∞ –≤—Å–µ, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å.',

    '–ü—É—Å—Ç—å –∫–∞–∂–¥—ã–π –≥–æ–¥ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏ –±—É–¥–µ—Ç –Ω–∞—Å—ã—â–µ–Ω –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏—è–º–∏, –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è–º–∏'
    ' –∏ —Å—á–∞—Å—Ç—å–µ–º. –° –¥–Ω–µ–º —Ä–æ–∂–¥–µ–Ω–∏—è!',

    '–°—á–∞—Å—Ç–ª–∏–≤–æ–≥–æ –¥–Ω—è —Ä–æ–∂–¥–µ–Ω–∏—è! –ñ–µ–ª–∞–µ–º –≤–∞–º –º–æ—â–Ω–æ–≥–æ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è,'
    ' —è—Ä–∫–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤ –∏ –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã—Ö –ª—é–¥–µ–π –≤ –≤–∞—à–µ–π –∂–∏–∑–Ω–∏.',
)


def render_congratulations(
        *,
        employee_birthdays: Iterable[EmployeeBirthday],
        unit_id_to_name: dict[int, str],
) -> str:
    lines = ['<b>–ë–∞–Ω–¥–∞, —Å–µ–≥–æ–¥–Ω—è —Å–≤–æ–π –¥–µ–Ω—å —Ä–æ–∂–¥–µ–Ω–∏—è –ø—Ä–∞–∑–¥–Ω—É—é—Ç:</b>\n']

    for employee_birthday in employee_birthdays:
        unit_name = unit_id_to_name.get(employee_birthday.unit_id)
        employee_name = employee_birthday.full_name

        if unit_name is None:
            lines.append(f'üéÅ {employee_name}')
        else:
            lines.append(f'üéÅ {employee_name} –∏–∑ –ø–∏—Ü—Ü–µ—Ä–∏–∏ {unit_name}')

    congratulation_phrase = random.choice(CONGRATULATIONS_PHRASES)

    lines.append(f'\n{congratulation_phrase}')

    return '\n'.join(lines)
